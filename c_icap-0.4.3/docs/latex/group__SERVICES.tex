\hypertarget{group__SERVICES}{
\section{Services API}
\label{group__SERVICES}\index{Services API@{Services API}}
}


Services related API.  
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structci__service__module}{ci\_\-service\_\-module}
\begin{DoxyCompactList}\small\item\em Is the structure which implements a service. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{
typedef struct ci\_\-service\_\-xdata \hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t}}
\label{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}

\begin{DoxyCompactList}\small\item\em Stores required data and settings for a service. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group__SERVICES_ga63811072507e9b7b78c841f1c9632ee1}{ci\_\-service\_\-set\_\-istag} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, const char $\ast$istag)
\begin{DoxyCompactList}\small\item\em Sets the ISTAG for the service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_ga7da5b123d299b8b91930fe5eb669e254}{ci\_\-service\_\-set\_\-xopts} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, uint64\_\-t xopts)
\begin{DoxyCompactList}\small\item\em Sets the service x-\/headers mask which defines the X-\/Headers supported by the service.The c-\/icap server will adverdise these headers in options responses. \item\end{DoxyCompactList}\item 
\hypertarget{group__SERVICES_ga249f9da52ed2a892da35f5d060435a17}{
void \hyperlink{group__SERVICES_ga249f9da52ed2a892da35f5d060435a17}{ci\_\-service\_\-add\_\-xopts} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, uint64\_\-t xopts)}
\label{group__SERVICES_ga249f9da52ed2a892da35f5d060435a17}

\begin{DoxyCompactList}\small\item\em it is similar to the function ci\_\-service\_\-set\_\-xopts but just adds (not sets) the X-\/Headers defined by the xopts parameter to the existing x-\/headers mask of service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f}{ci\_\-service\_\-set\_\-transfer\_\-preview} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, const char $\ast$preview)
\begin{DoxyCompactList}\small\item\em Set the list of file extensions that should previewed by the service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_gac7e9338092f802bc81dfb26dc2bf0e96}{ci\_\-service\_\-set\_\-transfer\_\-ignore} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, const char $\ast$ignore)
\begin{DoxyCompactList}\small\item\em Set the list of file extensions that should NOT be send for this service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_ga8390e88b95e0100d1a2728902f1d779b}{ci\_\-service\_\-set\_\-transfer\_\-complete} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, const char $\ast$complete)
\begin{DoxyCompactList}\small\item\em Set the list of file extensions that should be send in their entirety (without preview) to this service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_ga4baea98d2181bfa07189e048a889542a}{ci\_\-service\_\-set\_\-preview} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, int preview)
\begin{DoxyCompactList}\small\item\em Sets the maximum preview size supported by this service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_gafbb687c7869176c56b9217a61f400a9c}{ci\_\-service\_\-enable\_\-204} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata)
\begin{DoxyCompactList}\small\item\em Enable the allow 204 responses for this service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_gac2b4f2ae3dfdf1718b5a7ce5418a8e62}{ci\_\-service\_\-enable\_\-206} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata)
\begin{DoxyCompactList}\small\item\em Enable the Partial Content 206 responses for this service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_ga020a120d936c2061d20bdad2795e81dd}{ci\_\-service\_\-set\_\-max\_\-connections} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, int max\_\-connections)
\begin{DoxyCompactList}\small\item\em Sets the maximum connection should opened by icap client to the c-\/icap for this service. \item\end{DoxyCompactList}\item 
void \hyperlink{group__SERVICES_gadadb6757c8fee88a00e777bcc231433c}{ci\_\-service\_\-set\_\-options\_\-ttl} (\hyperlink{group__SERVICES_ga033e7bb0a88b3619abbc17230ad98eb4}{ci\_\-service\_\-xdata\_\-t} $\ast$srv\_\-xdata, int ttl)
\begin{DoxyCompactList}\small\item\em Sets the Options ttl for this service. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Services related API. For detailed information about implementing a service look the documentation of struct \hyperlink{structci__service__module}{ci\_\-service\_\-module} 

\subsection{Function Documentation}
\hypertarget{group__SERVICES_gafbb687c7869176c56b9217a61f400a9c}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-enable\_\-204@{ci\_\-service\_\-enable\_\-204}}
\index{ci\_\-service\_\-enable\_\-204@{ci\_\-service\_\-enable\_\-204}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-enable\_\-204}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-enable\_\-204 ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata})}}
\label{group__SERVICES_gafbb687c7869176c56b9217a61f400a9c}


Enable the allow 204 responses for this service. The service will supports the allow 204 responses if the icap client support it too. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \end{DoxyParams}
\begin{Desc}
\item[Examples: ]\par
\hyperlink{services_2echo_2srv__echo_8c-example}{services/echo/srv\_\-echo.c}.\end{Desc}
\hypertarget{group__SERVICES_gac2b4f2ae3dfdf1718b5a7ce5418a8e62}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-enable\_\-206@{ci\_\-service\_\-enable\_\-206}}
\index{ci\_\-service\_\-enable\_\-206@{ci\_\-service\_\-enable\_\-206}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-enable\_\-206}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-enable\_\-206 ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata})}}
\label{group__SERVICES_gac2b4f2ae3dfdf1718b5a7ce5418a8e62}


Enable the Partial Content 206 responses for this service. The service will supports the Partial Content 206 responses if the icap client support it too. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \end{DoxyParams}
\hypertarget{group__SERVICES_ga63811072507e9b7b78c841f1c9632ee1}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-istag@{ci\_\-service\_\-set\_\-istag}}
\index{ci\_\-service\_\-set\_\-istag@{ci\_\-service\_\-set\_\-istag}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-istag}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-istag ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  const char $\ast$ {\em istag})}}
\label{group__SERVICES_ga63811072507e9b7b78c841f1c9632ee1}


Sets the ISTAG for the service. Normally this function called in \hyperlink{structci__service__module_acf9f56283f9418715be2f87967928876}{ci\_\-service\_\-module::mod\_\-init\_\-service()} or \hyperlink{structci__service__module_a3975fa968c80e30d77f3f1bac100e9e1}{ci\_\-service\_\-module::mod\_\-post\_\-init\_\-service()} function, while the service initialization. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em istag}]is a string contains the new ISTAG for the service. The istag size can not be more than a size of SERVICE\_\-ISTAG\_\-SIZE. If the lenght of istag is greater than SERVICE\_\-ISTAG\_\-SIZE the extra bytes ignored. \end{DoxyParams}
\hypertarget{group__SERVICES_ga020a120d936c2061d20bdad2795e81dd}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-max\_\-connections@{ci\_\-service\_\-set\_\-max\_\-connections}}
\index{ci\_\-service\_\-set\_\-max\_\-connections@{ci\_\-service\_\-set\_\-max\_\-connections}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-max\_\-connections}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-max\_\-connections ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  int {\em max\_\-connections})}}
\label{group__SERVICES_ga020a120d936c2061d20bdad2795e81dd}


Sets the maximum connection should opened by icap client to the c-\/icap for this service. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em max\_\-connections}]is the maximum connections \end{DoxyParams}
\hypertarget{group__SERVICES_gadadb6757c8fee88a00e777bcc231433c}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-options\_\-ttl@{ci\_\-service\_\-set\_\-options\_\-ttl}}
\index{ci\_\-service\_\-set\_\-options\_\-ttl@{ci\_\-service\_\-set\_\-options\_\-ttl}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-options\_\-ttl}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-options\_\-ttl ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  int {\em ttl})}}
\label{group__SERVICES_gadadb6757c8fee88a00e777bcc231433c}


Sets the Options ttl for this service. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em ttl}]is the ttl value in seconds \end{DoxyParams}
\hypertarget{group__SERVICES_ga4baea98d2181bfa07189e048a889542a}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-preview@{ci\_\-service\_\-set\_\-preview}}
\index{ci\_\-service\_\-set\_\-preview@{ci\_\-service\_\-set\_\-preview}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-preview}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-preview ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  int {\em preview})}}
\label{group__SERVICES_ga4baea98d2181bfa07189e048a889542a}


Sets the maximum preview size supported by this service. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em preview}]is the size of preview data supported by this service \end{DoxyParams}
\begin{Desc}
\item[Examples: ]\par
\hyperlink{services_2echo_2srv__echo_8c-example}{services/echo/srv\_\-echo.c}.\end{Desc}
\hypertarget{group__SERVICES_ga8390e88b95e0100d1a2728902f1d779b}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-transfer\_\-complete@{ci\_\-service\_\-set\_\-transfer\_\-complete}}
\index{ci\_\-service\_\-set\_\-transfer\_\-complete@{ci\_\-service\_\-set\_\-transfer\_\-complete}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-transfer\_\-complete}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-transfer\_\-complete ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  const char $\ast$ {\em complete})}}
\label{group__SERVICES_ga8390e88b95e0100d1a2728902f1d779b}


Set the list of file extensions that should be send in their entirety (without preview) to this service. The c-\/icap will inform the ICAP client that should send files which have the extensions contained in the complete string, in their entirety to this service. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em complete}]is the string which contains the list of the file extensions.\end{DoxyParams}
example usage: 
\begin{DoxyCode}
   ci_service_set_transfer_complete(srv_xdata,"exe, bat, com, ole");
\end{DoxyCode}
 \hypertarget{group__SERVICES_gac7e9338092f802bc81dfb26dc2bf0e96}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-transfer\_\-ignore@{ci\_\-service\_\-set\_\-transfer\_\-ignore}}
\index{ci\_\-service\_\-set\_\-transfer\_\-ignore@{ci\_\-service\_\-set\_\-transfer\_\-ignore}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-transfer\_\-ignore}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-transfer\_\-ignore ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  const char $\ast$ {\em ignore})}}
\label{group__SERVICES_gac7e9338092f802bc81dfb26dc2bf0e96}


Set the list of file extensions that should NOT be send for this service. The c-\/icap will inform the ICAP client that should not send files which have the extensions contained in the ignore string. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em ignore}]is the string which contains the list of the file extensions.\end{DoxyParams}
example usage: 
\begin{DoxyCode}
   ci_service_set_transfer_ignore(srv_xdata,"gif, jpeg");
\end{DoxyCode}
 \hypertarget{group__SERVICES_gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-transfer\_\-preview@{ci\_\-service\_\-set\_\-transfer\_\-preview}}
\index{ci\_\-service\_\-set\_\-transfer\_\-preview@{ci\_\-service\_\-set\_\-transfer\_\-preview}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-transfer\_\-preview}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-transfer\_\-preview ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  const char $\ast$ {\em preview})}}
\label{group__SERVICES_gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f}


Set the list of file extensions that should previewed by the service. The c-\/icap will inform the ICAP client that should send preview data for the files which have the extensions contained in the preview string. The wildcard value \char`\"{}$\ast$\char`\"{} specifies all files extensions, which is the default. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em preview}]is the string which contains the list of the file extensions.\end{DoxyParams}
example usage: 
\begin{DoxyCode}
   ci_service_set_transfer_preview(srv_xdata,"zip, tar");
\end{DoxyCode}
 \begin{Desc}
\item[Examples: ]\par
\hyperlink{services_2echo_2srv__echo_8c-example}{services/echo/srv\_\-echo.c}.\end{Desc}
\hypertarget{group__SERVICES_ga7da5b123d299b8b91930fe5eb669e254}{
\index{SERVICES@{SERVICES}!ci\_\-service\_\-set\_\-xopts@{ci\_\-service\_\-set\_\-xopts}}
\index{ci\_\-service\_\-set\_\-xopts@{ci\_\-service\_\-set\_\-xopts}!SERVICES@{SERVICES}}
\subsubsection[{ci\_\-service\_\-set\_\-xopts}]{\setlength{\rightskip}{0pt plus 5cm}void ci\_\-service\_\-set\_\-xopts ({\bf ci\_\-service\_\-xdata\_\-t} $\ast$ {\em srv\_\-xdata}, \/  uint64\_\-t {\em xopts})}}
\label{group__SERVICES_ga7da5b123d299b8b91930fe5eb669e254}


Sets the service x-\/headers mask which defines the X-\/Headers supported by the service.The c-\/icap server will adverdise these headers in options responses. Normally this function called in \hyperlink{structci__service__module_acf9f56283f9418715be2f87967928876}{ci\_\-service\_\-module::mod\_\-init\_\-service()} or \hyperlink{structci__service__module_a3975fa968c80e30d77f3f1bac100e9e1}{ci\_\-service\_\-module::mod\_\-post\_\-init\_\-service()} function, while the service initialization. 
\begin{DoxyParams}{Parameters}
\item[{\em srv\_\-xdata}]is a pointer to the c-\/icap internal service data. \item[{\em xopts}]is a compination of one or more of the following defines:
\begin{DoxyItemize}
\item CI\_\-XCLIENTIP: Refers to the X-\/Client-\/IP header. The HTTP proxy (or the ICAP client) will sends the ip address of the HTTP client using this header if supports this header.
\item CI\_\-XSERVERIP: The X-\/Server-\/IP header. The HTTP proxy will incluse the IP of the HTTP destination host in the X-\/Server-\/IP header if supports this header.
\item CI\_\-XSUBSCRIBERID: The X-\/Subscriber-\/ID header. This header can include a unique subscriber ID of the user who issued the HTTP request
\item CI\_\-XAUTHENTICATEDUSER: The X-\/Authenticated-\/User header. If the user has been authenticated on HTTP proxy the HTTP proxy will send the authenticated user name.
\item CI\_\-XAUTHENTICATEDGROUPS: The X-\/Authenticated-\/Group header. If the user has been authenticated on HTTP proxy and belongs to some groups the HTTP proxy will send these groups using this header.
\end{DoxyItemize}\end{DoxyParams}
example usage: 
\begin{DoxyCode}
 ci_service_set_xopts(srv_xdata,CI_XCLIENTIP|CI_XAUTHENTICATEDUSER);
\end{DoxyCode}


For more informations about ICAP common X-\/Headers look at: \href{http://www.icap-forum.org/documents/specification/draft-stecher-icap-subid-00.txt}{\tt http://www.icap-\/forum.org/documents/specification/draft-\/stecher-\/icap-\/subid-\/00.txt} \begin{Desc}
\item[Examples: ]\par
\hyperlink{services_2echo_2srv__echo_8c-example}{services/echo/srv\_\-echo.c}.\end{Desc}
