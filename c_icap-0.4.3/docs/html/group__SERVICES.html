<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>c-icap-doc: Services API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Services API<br/>
<small>
[<a class="el" href="group__API.html">API  Documentation</a>]</small>
</h1>
<p>Services related API.  
<a href="#_details">More...</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structci__service__module.html">ci_service_module</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Is the structure which implements a service.  <a href="structci__service__module.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga033e7bb0a88b3619abbc17230ad98eb4"></a><!-- doxytag: member="SERVICES::ci_service_xdata_t" ref="ga033e7bb0a88b3619abbc17230ad98eb4" args="" -->
typedef struct ci_service_xdata&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stores required data and settings for a service. <br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#ga63811072507e9b7b78c841f1c9632ee1">ci_service_set_istag</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, const char *istag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the ISTAG for the service.  <a href="#ga63811072507e9b7b78c841f1c9632ee1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#ga7da5b123d299b8b91930fe5eb669e254">ci_service_set_xopts</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, uint64_t xopts)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the service x-headers mask which defines the X-Headers supported by the service.The c-icap server will adverdise these headers in options responses.  <a href="#ga7da5b123d299b8b91930fe5eb669e254"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga249f9da52ed2a892da35f5d060435a17"></a><!-- doxytag: member="SERVICES::ci_service_add_xopts" ref="ga249f9da52ed2a892da35f5d060435a17" args="(ci_service_xdata_t *srv_xdata, uint64_t xopts)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#ga249f9da52ed2a892da35f5d060435a17">ci_service_add_xopts</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, uint64_t xopts)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">it is similar to the function ci_service_set_xopts but just adds (not sets) the X-Headers defined by the xopts parameter to the existing x-headers mask of service. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f">ci_service_set_transfer_preview</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, const char *preview)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the list of file extensions that should previewed by the service.  <a href="#gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#gac7e9338092f802bc81dfb26dc2bf0e96">ci_service_set_transfer_ignore</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, const char *ignore)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the list of file extensions that should NOT be send for this service.  <a href="#gac7e9338092f802bc81dfb26dc2bf0e96"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#ga8390e88b95e0100d1a2728902f1d779b">ci_service_set_transfer_complete</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, const char *complete)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the list of file extensions that should be send in their entirety (without preview) to this service.  <a href="#ga8390e88b95e0100d1a2728902f1d779b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#ga4baea98d2181bfa07189e048a889542a">ci_service_set_preview</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, int preview)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the maximum preview size supported by this service.  <a href="#ga4baea98d2181bfa07189e048a889542a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#gafbb687c7869176c56b9217a61f400a9c">ci_service_enable_204</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable the allow 204 responses for this service.  <a href="#gafbb687c7869176c56b9217a61f400a9c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#gac2b4f2ae3dfdf1718b5a7ce5418a8e62">ci_service_enable_206</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable the Partial Content 206 responses for this service.  <a href="#gac2b4f2ae3dfdf1718b5a7ce5418a8e62"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#ga020a120d936c2061d20bdad2795e81dd">ci_service_set_max_connections</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, int max_connections)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the maximum connection should opened by icap client to the c-icap for this service.  <a href="#ga020a120d936c2061d20bdad2795e81dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SERVICES.html#gadadb6757c8fee88a00e777bcc231433c">ci_service_set_options_ttl</a> (<a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *srv_xdata, int ttl)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the Options ttl for this service.  <a href="#gadadb6757c8fee88a00e777bcc231433c"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Services related API. </p>
<p>For detailed information about implementing a service look the documentation of struct <a class="el" href="structci__service__module.html" title="Is the structure which implements a service.">ci_service_module</a> </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gafbb687c7869176c56b9217a61f400a9c"></a><!-- doxytag: member="service.h::ci_service_enable_204" ref="gafbb687c7869176c56b9217a61f400a9c" args="(ci_service_xdata_t *srv_xdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_enable_204 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enable the allow 204 responses for this service. </p>
<p>The service will supports the allow 204 responses if the icap client support it too. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="services_2echo_2srv__echo_8c-example.html#a3">services/echo/srv_echo.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="gac2b4f2ae3dfdf1718b5a7ce5418a8e62"></a><!-- doxytag: member="service.h::ci_service_enable_206" ref="gac2b4f2ae3dfdf1718b5a7ce5418a8e62" args="(ci_service_xdata_t *srv_xdata)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_enable_206 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enable the Partial Content 206 responses for this service. </p>
<p>The service will supports the Partial Content 206 responses if the icap client support it too. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga63811072507e9b7b78c841f1c9632ee1"></a><!-- doxytag: member="service.h::ci_service_set_istag" ref="ga63811072507e9b7b78c841f1c9632ee1" args="(ci_service_xdata_t *srv_xdata, const char *istag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_istag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>istag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the ISTAG for the service. </p>
<p>Normally this function called in <a class="el" href="structci__service__module.html#acf9f56283f9418715be2f87967928876" title="Pointer to the function called when the service loaded.">ci_service_module::mod_init_service()</a> or <a class="el" href="structci__service__module.html#a3975fa968c80e30d77f3f1bac100e9e1" title="Pointer to the function which called after the c-icap initialized, but before the...">ci_service_module::mod_post_init_service()</a> function, while the service initialization. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>istag</em>&nbsp;</td><td>is a string contains the new ISTAG for the service. The istag size can not be more than a size of SERVICE_ISTAG_SIZE. If the lenght of istag is greater than SERVICE_ISTAG_SIZE the extra bytes ignored. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga020a120d936c2061d20bdad2795e81dd"></a><!-- doxytag: member="service.h::ci_service_set_max_connections" ref="ga020a120d936c2061d20bdad2795e81dd" args="(ci_service_xdata_t *srv_xdata, int max_connections)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_max_connections </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max_connections</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the maximum connection should opened by icap client to the c-icap for this service. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>max_connections</em>&nbsp;</td><td>is the maximum connections </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gadadb6757c8fee88a00e777bcc231433c"></a><!-- doxytag: member="service.h::ci_service_set_options_ttl" ref="gadadb6757c8fee88a00e777bcc231433c" args="(ci_service_xdata_t *srv_xdata, int ttl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_options_ttl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ttl</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the Options ttl for this service. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ttl</em>&nbsp;</td><td>is the ttl value in seconds </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga4baea98d2181bfa07189e048a889542a"></a><!-- doxytag: member="service.h::ci_service_set_preview" ref="ga4baea98d2181bfa07189e048a889542a" args="(ci_service_xdata_t *srv_xdata, int preview)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_preview </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>preview</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the maximum preview size supported by this service. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>preview</em>&nbsp;</td><td>is the size of preview data supported by this service </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="services_2echo_2srv__echo_8c-example.html#a2">services/echo/srv_echo.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga8390e88b95e0100d1a2728902f1d779b"></a><!-- doxytag: member="service.h::ci_service_set_transfer_complete" ref="ga8390e88b95e0100d1a2728902f1d779b" args="(ci_service_xdata_t *srv_xdata, const char *complete)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_transfer_complete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>complete</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the list of file extensions that should be send in their entirety (without preview) to this service. </p>
<p>The c-icap will inform the ICAP client that should send files which have the extensions contained in the complete string, in their entirety to this service. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>complete</em>&nbsp;</td><td>is the string which contains the list of the file extensions.</td></tr>
  </table>
  </dd>
</dl>
<p>example usage: </p>
<div class="fragment"><pre class="fragment">   <a class="code" href="group__SERVICES.html#ga8390e88b95e0100d1a2728902f1d779b" title="Set the list of file extensions that should be send in their entirety (without preview)...">ci_service_set_transfer_complete</a>(srv_xdata,<span class="stringliteral">&quot;exe, bat, com, ole&quot;</span>);
</pre></div> 
</div>
</div>
<a class="anchor" id="gac7e9338092f802bc81dfb26dc2bf0e96"></a><!-- doxytag: member="service.h::ci_service_set_transfer_ignore" ref="gac7e9338092f802bc81dfb26dc2bf0e96" args="(ci_service_xdata_t *srv_xdata, const char *ignore)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_transfer_ignore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>ignore</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the list of file extensions that should NOT be send for this service. </p>
<p>The c-icap will inform the ICAP client that should not send files which have the extensions contained in the ignore string. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ignore</em>&nbsp;</td><td>is the string which contains the list of the file extensions.</td></tr>
  </table>
  </dd>
</dl>
<p>example usage: </p>
<div class="fragment"><pre class="fragment">   <a class="code" href="group__SERVICES.html#gac7e9338092f802bc81dfb26dc2bf0e96" title="Set the list of file extensions that should NOT be send for this service.">ci_service_set_transfer_ignore</a>(srv_xdata,<span class="stringliteral">&quot;gif, jpeg&quot;</span>);
</pre></div> 
</div>
</div>
<a class="anchor" id="gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f"></a><!-- doxytag: member="service.h::ci_service_set_transfer_preview" ref="gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f" args="(ci_service_xdata_t *srv_xdata, const char *preview)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_transfer_preview </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>preview</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the list of file extensions that should previewed by the service. </p>
<p>The c-icap will inform the ICAP client that should send preview data for the files which have the extensions contained in the preview string. The wildcard value "*" specifies all files extensions, which is the default. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>preview</em>&nbsp;</td><td>is the string which contains the list of the file extensions.</td></tr>
  </table>
  </dd>
</dl>
<p>example usage: </p>
<div class="fragment"><pre class="fragment">   <a class="code" href="group__SERVICES.html#gafc50c2c4ef2c9d96c7f8d6c2f2bf5d2f" title="Set the list of file extensions that should previewed by the service.">ci_service_set_transfer_preview</a>(srv_xdata,<span class="stringliteral">&quot;zip, tar&quot;</span>);
</pre></div> <dl><dt><b>Examples: </b></dt><dd><a class="el" href="services_2echo_2srv__echo_8c-example.html#a4">services/echo/srv_echo.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ga7da5b123d299b8b91930fe5eb669e254"></a><!-- doxytag: member="service.h::ci_service_set_xopts" ref="ga7da5b123d299b8b91930fe5eb669e254" args="(ci_service_xdata_t *srv_xdata, uint64_t xopts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ci_service_set_xopts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__SERVICES.html#ga033e7bb0a88b3619abbc17230ad98eb4">ci_service_xdata_t</a> *&nbsp;</td>
          <td class="paramname"> <em>srv_xdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>xopts</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the service x-headers mask which defines the X-Headers supported by the service.The c-icap server will adverdise these headers in options responses. </p>
<p>Normally this function called in <a class="el" href="structci__service__module.html#acf9f56283f9418715be2f87967928876" title="Pointer to the function called when the service loaded.">ci_service_module::mod_init_service()</a> or <a class="el" href="structci__service__module.html#a3975fa968c80e30d77f3f1bac100e9e1" title="Pointer to the function which called after the c-icap initialized, but before the...">ci_service_module::mod_post_init_service()</a> function, while the service initialization. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srv_xdata</em>&nbsp;</td><td>is a pointer to the c-icap internal service data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>xopts</em>&nbsp;</td><td>is a compination of one or more of the following defines:</p>
<ul>
<li>CI_XCLIENTIP: Refers to the X-Client-IP header. The HTTP proxy (or the ICAP client) will sends the ip address of the HTTP client using this header if supports this header.</li>
<li>CI_XSERVERIP: The X-Server-IP header. The HTTP proxy will incluse the IP of the HTTP destination host in the X-Server-IP header if supports this header.</li>
<li>CI_XSUBSCRIBERID: The X-Subscriber-ID header. This header can include a unique subscriber ID of the user who issued the HTTP request</li>
<li>CI_XAUTHENTICATEDUSER: The X-Authenticated-User header. If the user has been authenticated on HTTP proxy the HTTP proxy will send the authenticated user name.</li>
<li>CI_XAUTHENTICATEDGROUPS: The X-Authenticated-Group header. If the user has been authenticated on HTTP proxy and belongs to some groups the HTTP proxy will send these groups using this header.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<p>example usage: </p>
<div class="fragment"><pre class="fragment"> <a class="code" href="group__SERVICES.html#ga7da5b123d299b8b91930fe5eb669e254" title="Sets the service x-headers mask which defines the X-Headers supported by the service...">ci_service_set_xopts</a>(srv_xdata,CI_XCLIENTIP|CI_XAUTHENTICATEDUSER);
</pre></div><p>For more informations about ICAP common X-Headers look at: <a href="http://www.icap-forum.org/documents/specification/draft-stecher-icap-subid-00.txt">http://www.icap-forum.org/documents/specification/draft-stecher-icap-subid-00.txt</a> </p>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="services_2echo_2srv__echo_8c-example.html#a5">services/echo/srv_echo.c</a>.</dd>
</dl>
</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 14 Jun 2016 for c-icap-doc by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
